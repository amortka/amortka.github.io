(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{100:function(e,t,n){},140:function(e,t){},142:function(e,t){},174:function(e,t,n){"use strict";n.r(t);var a,i,o=n(3),r=n.n(o),s=n(86),c=n.n(s),l=(n(98),n(44)),u=n(6),h=n(8),p=n(20),d=n(18),f=n(19),m=n(10),v=(n(100),n(55)),y=n.n(v),g=n(178),b=n(179),w=n(43),_=n.n(w),O=n(56),x=n.n(O),M=n(1),j=n(87),k=n.n(j),E=function(){function e(t,n){var i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(Object(u.a)(this,e),a)return a;this.controls=new k.a(t,n),this.controls.enabled=i,this.controls.enableDamping=!0,this.controls.dampingFactor=.1,this.controls.rotateSpeed=.2,this.controls.autoRotateSpeed=.1,this.controls.minPolarAngle=0,this.controls.maxPolarAngle=Math.PI/2-Math.PI/180*0,a=this}return Object(h.a)(e,[{key:"enable",value:function(){this.controls.enabled=!0}},{key:"disable",value:function(){this.controls.enabled=!1}},{key:"update",value:function(){this.controls.update()}}]),e}(),S=6378137,C=[17.038538,51.107883],P=function(e){return 3.14159*e/180},L=function(e){return 180*e/3.14159},B=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;if(Object(u.a)(this,e),i)return i;this.lon=Array.isArray(t)?t[0]:t.lon,this.lat=Array.isArray(t)?t[1]:t.lat,this.latInRadians=P(this.lat),this.k=n,this.radius=S,i=this}return Object(h.a)(e,[{key:"fromGeo",value:function(e,t){var n=P(t),a=P(e-this.lon),i=Math.sin(a)*Math.cos(n);return{x:.5*this.k*this.radius*Math.log((1+i)/(1-i)),y:-this.k*this.radius*(Math.atan(Math.tan(n)/Math.cos(a))-this.latInRadians)}}},{key:"fromXY",value:function(e,t){var n=e/(this.k*this.radius),a=t/(this.k*this.radius)+this.latInRadians,i=Math.atan(Math.sinh(n)/Math.cos(a)),o=Math.asin(Math.sin(a)/Math.cosh(n));return i=this.lon+L(i),{lat:o=L(o),lon:i}}}]),e}(),F=n(175),z=n(153),A=(new M.Vector3(0,0,0),function(){function e(t){Object(u.a)(this,e),console.log("SceneManager()"),this.canvas=t,this.dimensions={width:t.width,height:t.height},this.layers=[],this.init(),this.destroyed=!1}return Object(h.a)(e,[{key:"destroy",value:function(){console.log("destroy:",this.c),this.destroyed=!0,window.cancelAnimationFrame(this.raf),document.removeEventListener("keydown",this.onKeyDown,!1),this.layers.forEach(function(e){return e.destroy()})}},{key:"init",value:function(){this.initScene(),this.initRenderer(),this.initCamera(),this.initMercator(),this.initHelpers(),this.initControls(),this.initEvents(),this.loop()}},{key:"loop",value:function(){var e=this;this.destroyed||(this.update(),this.render(),this.raf=window.requestAnimationFrame(function(){return e.loop()}))}},{key:"initScene",value:function(){this.scene=new M.Scene,this.layersGroup=new M.Group,this.layersGroup.name="main_group",this.scene.add(this.layersGroup)}},{key:"initHelpers",value:function(){new M.AxesHelper(1e3);var e=new M.GridHelper(1e5,1e3,1752220,1752220);e.position.setY(0),e.material.blending=M.AdditiveBlending,e.material.opacity=.1,e.material.transparent=!0,this.scene.add(e);var t=new M.OctahedronGeometry(10),n=new M.MeshNormalMaterial;this.cameraPositionHelper=new M.Mesh(t,n)}},{key:"initRenderer",value:function(){var e=new M.WebGLRenderer({canvas:this.canvas,alpha:!0,antialias:!1});e.setClearColor(16777215,0),e.shadowMap.soft=!1,e.shadowMap.enabled=!0,e.setPixelRatio(window.devicePixelRatio),e.setSize(window.innerWidth,window.innerHeight),this.renderer=e}},{key:"initCamera",value:function(){this.cameraTargetPosition=new M.Vector3(0,3e3,0);var e=this.canvas.width/this.canvas.height;this.camera=new M.PerspectiveCamera(20,e,10,5e4),this.camera.position.set(100,100,50)}},{key:"initControls",value:function(){this.cameraTarget=new M.Vector3(0,0,0),this.camera.position.set(674.4484878333734,699.3695242813109,1679.9599093246045),this.cameraControls=new E(this.camera,this.canvas),this.loadCameraFromLS(),this.cameraControls.update();var e=window.innerWidth,t=window.innerHeight;this.cameraMove$=Object(F.a)(window,"mousemove",{passive:!0}),this.cameraMove$.pipe(Object(z.a)(function(n){var a=n.clientX,i=n.clientY;return{x:a/e*2-1,y:i/t*2-1}})).subscribe(function(e){var t=e.x;e.y,P(30*t)})}},{key:"initEvents",value:function(){this.onKeyDown=this.onKeyDown.bind(this),document.addEventListener("keydown",this.onKeyDown,!1)}},{key:"initMercator",value:function(){this.mercator=new B(C,.1)}},{key:"loadCameraFromLS",value:function(){var e=JSON.parse(localStorage.getItem("".concat("wroclovedata_","_controls")));e&&this.cameraControls&&(this.cameraControls.controls.target.copy(e.target),this.cameraControls.controls.object.position.copy(e.position),this.cameraControls.controls.object.zoom=e.zoom)}},{key:"saveControlsLS",value:function(){var e={target:this.cameraControls.controls.target,position:this.cameraControls.controls.object.position,zoom:this.cameraControls.controls.object.zoom};console.log("controls",{controls:e}),localStorage.setItem("".concat("wroclovedata_","_controls"),JSON.stringify(e))}},{key:"onKeyDown",value:function(e){switch(e.keyCode){case 83:this.saveControlsLS();break;case 68:console.log("LOAD camera from LS <=="),this.loadCameraFromLS()}}},{key:"render",value:function(){this.renderer.render(this.scene,this.camera)}},{key:"update",value:function(){this.cameraControls.update(),this.layers.forEach(function(e){return e.update()})}},{key:"addLayer",value:function(e){this.layers.push(e),e.init(this.layersGroup)}},{key:"setLayerVisibility",value:function(e,t){e.group.traverse(function(e){e instanceof M.Mesh&&(e.visible=t)})}},{key:"setLayerOpacity",value:function(e,t,n){e.setOpacity(t,n)}}]),e}()),R=n(16),G=n(181),T=n(0),N=n(28),W=(n(154),function(){function e(t,n){Object(u.a)(this,e),this.data=_()(t,{columns:!0}),console.log("points:",this.data.length),this.options=Object(R.a)({},n,{columns:!0}),this.mercator=new B}return Object(h.a)(e,[{key:"init",value:function(e){this.group=new M.Group,this.group.name="CSVLayer.group",e.add(this.group),this.createObjects()}},{key:"destroy",value:function(){}},{key:"createObjects",value:function(){var e=this,t=[4056753,2288880,1692157,1356285,2916315,4018879,6633907,10498738,13706409,16454556,16600491,16689108,16777215].map(function(e){return new M.Color(e)}),n=Object(N.a)().domain([3,6,9,12,15,18,21,24,27,30,33,36,39]).range(t),a={u_scaleZ:{type:"f",value:0},u_circle:{type:"f",value:1},u_circle2:{type:"f",value:1},u_resolution:{type:"v2",value:{x:window.innerWidth,y:window.innerHeight}}},i=new M.BufferGeometry,o=[],r=new Float32Array(2*this.data.length),s=new Float32Array(2*this.data.length),c=[];this.data.forEach(function(t,a){var i=e.mercator.fromGeo(parseFloat(t.X),parseFloat(t.Y)),l=i.x,u=i.y,h=t.value;o.push(l,0,u),o.push(l,h,u);var p=a/e.data.length*2*3.14159;r[2*a]=p,r[2*a+1]=p;var d=2*Math.random()-1;s[2*a]=d,s[2*a+1]=d;var f=n(h);new M.Vector3(255*f.r,255*f.g,255*f.b);c.push(f.r,f.g,f.b),c.push(f.r,f.g,f.b)}),i.addAttribute("position",new M.Float32BufferAttribute(o,3)),i.addAttribute("a_degree",new M.BufferAttribute(r,1)),i.addAttribute("a_displacement",new M.BufferAttribute(s,1)),i.addAttribute("a_color",new M.Float32BufferAttribute(c,3));var l=new M.ShaderMaterial({uniforms:a,vertexShader:"\nattribute float a_degree;\nattribute float a_displacement;\nattribute vec3 a_color;\n\n// varying float r;\n// varying float g;\n// varying float b;\nvarying vec3 color;\n\nuniform float u_scaleZ;\nuniform float u_circle;\nuniform float u_circle2;\n\nvoid main() { \n  //Every vertex shader must eventually set 'gl_Position' \n  //And in this case, we multiply the vertex position with the camera view and screen matrix to get the final output. \n\n  float d = a_degree;\n\n  // float x = (1.0 - u_circle) * position.x + \n  //   ((1000.0 + 10.0 * a_displacement) * sin(a_degree * u_circle2 + position.x/10.0 )) * u_circle;\n  // float y = position.y * u_scaleZ + 20.0 * u_circle;\n  // float z = (1.0 - u_circle) * position.z + \n  //   ((1000.0 + 10.0 * a_displacement) * cos(a_degree * u_circle2 + position.z/10.0 )) * u_circle;\n\n  float x = (1.0 - u_circle) * position.x + \n    ((2000.0 + 100.0 * a_displacement) * sin(a_degree * u_circle2)) * u_circle;\n    \n  float y = (position.y * 0.5) * u_scaleZ;\n\n  float z = (1.0 - u_circle) * position.z + \n    ((2000.0 + 100.0 * a_displacement) * cos(a_degree * u_circle2)) * u_circle;\n\n\n  // float s = sqrt(pow(position.x, 2.0) + pow(position.y, 2.0)) * 0.1;\n  // float x = (1.0 - u_circle) * position.x / (1.0 + (s * u_circle)); \n  // float y = (1.0 - u_circle) * position.y;// + s * position.y * u_circle;\n  // float z = (1.0 - u_circle) * position.z / (1.0 + (s * u_circle));\n\n  \n  color = a_color;\n  gl_Position = projectionMatrix * modelViewMatrix * vec4(vec3(x, y, z), 1.0);\n }\n",fragmentShader:"\n//Just as vertex shader, fragment shader must in the end set this variable (gl_FragColor)\n//We set it to a pink color.\nuniform vec2 u_resolution;\nuniform float u_time;\n\nvarying vec3 color;\n\nvoid main() {\n  vec2 st = gl_FragCoord.xy / u_resolution.xy;\n\n  gl_FragColor = vec4( color, 1.0);\n  // gl_FragColor = vec4(1.0,  // R\n                    //  1.0,  // G\n                    //  1.0,  // B\n                    //  1.0); // A\n}\n",blending:M.AdditiveBlending}),u=new M.LineSegments(i,l);this.group.add(u);var h={u_scaleZ:.1,u_circle:1,u_circle2:1};new G.a({repeat:-1,repeatDelay:1,yoyo:!0,onUpdate:function(e){a.u_circle.value=h.u_circle,a.u_circle2.value=h.u_circle2,a.u_scaleZ.value=h.u_scaleZ}}).to(h,5,{u_circle:0,u_scaleZ:1,u_circle2:5,ease:T.c.easeInOut});console.timeEnd("createObjects")}},{key:"update",value:function(){}}]),e}());var D=n(88),Z=n(24),q=n(176),V=n(92),$=[4056753,2288880,1692157,1356285,2916315,4018879,6633907,10498738,13706409,16454556,16600491,16689108,16777215].map(function(e){return new M.MeshBasicMaterial({color:e,side:M.DoubleSide})}),I=Object(N.a)().domain([3,6,9,12,15,18,21,24,27,30,33,36,39]).range($),H=function(){function e(t,n){Object(u.a)(this,e),this.geojson=t,this.options=Object(R.a)({},n),this.mercator=new B}return Object(h.a)(e,[{key:"init",value:function(e){var t=this;this.group=new M.Group,this.group.name="GeoJsonLayer.group",e.add(this.group),Object(D.featureEach)(this.geojson,function(e,n){return t.createMesh(e,n)})}},{key:"destroy",value:function(){}},{key:"createMesh",value:function(e,t){var n=this,a=new M.Geometry,i=[];"MultiPolygon"===Object(Z.getType)(e)?Object(Z.getCoords)(e).forEach(function(e){return i.push(e)}):(Object(Z.getType)(e),i.push(Object(Z.getCoords)(e)));i.forEach(function(i,o){var r=Object(Z.getCoord)(Object(Z.centroid)(Object(Z.polygon)(i))),s=n.mercator.fromGeo(r[0],r[1]);if(n.options.fill){var c=new M.Shape,l=i[0].map(function(e){return n.mercator.fromGeo(e[0],e[1])}),u=l.shift();c.moveTo(u.x-s.x,u.y-s.y),l.forEach(function(e){c.lineTo(e.x-s.x,e.y-s.y)});var h=new M.ExtrudeGeometry(c,{amount:-5,bevelEnabled:!0,bevelSegments:2,steps:2,bevelSize:1,bevelThickness:1}),p=new M.Mesh(h,I(e.properties.value));p.position.set(s.x,0,s.y),p.rotation.x=1.5707963,n.group.add(p)}else{var d=i[0].map(function(e){var t=n.mercator.fromGeo(e[0],e[1]);return new M.Vector3(t.x-s.x,0,t.y-s.y)});Object(V.a)(d,function(e,t){return a.vertices.push(e,t)});var f=new M.LineBasicMaterial({color:n.options.color||6815486,opacity:0,transparent:!0}),m=new M.LineSegments(a,f);m.scale.set(.001,1,.001),m.position.set(s.x,n.options.pos||5,s.y);var v={_scale:.001};if(T.f.to(v,1,{_scale:1,delay:1+.03*t,ease:q.a.config(10),onUpdate:function(e){m.scale.set(v._scale,1,v._scale),m.material.opacity=v._scale*(n.options.opacity||.3)}}),n.group.add(m),1===e.properties.NROSIEDLA){var y=m.clone();y.material.color.setHex(3447003),y.scale.set(.99,1,.99),n.group.add(y)}}})}},{key:"update",value:function(){}}]),e}(),Y=function(){function e(t,n,a){Object(u.a)(this,e),this.imgUrl=t,this.bounds=n,this.options=Object(R.a)({},a),this.mercator=new B,this.timeline=null,this.direction=1}return Object(h.a)(e,[{key:"destroy",value:function(){}},{key:"init",value:function(e){this.group=new M.Group,this.group.name="ImageLayer.group",e.add(this.group),this.initSize(),this.initLoader(),this.createMesh()}},{key:"initSize",value:function(){var e=this;this.boundsPixel=[this.mercator.fromGeo(this.bounds[0],this.bounds[1]),this.mercator.fromGeo(this.bounds[2],this.bounds[3])],this.size={x:Math.abs(this.boundsPixel[0].x-this.boundsPixel[1].x),y:Math.abs(this.boundsPixel[0].y-this.boundsPixel[1].y)},[[this.boundsPixel[0].x,this.boundsPixel[0].y],[this.boundsPixel[1].x,this.boundsPixel[1].y]].forEach(function(t){var n=new M.OctahedronGeometry(10),a=new M.MeshNormalMaterial,i=new M.Mesh(n,a);i.position.set(t[0],0,t[1]),e.group.add(i)})}},{key:"initLoader",value:function(){this.loadingManager=new M.LoadingManager,this.loadingManager.onLoad=this.onComplete.bind(this),this.loader=new M.TextureLoader(this.loadingManager),this.loader.crossOrigin="Anonymous"}},{key:"createMesh",value:function(){var e=this;this.loader.load(this.imgUrl,function(t){return e.texture=t}),this.options.alphaMap&&this.loader.load(this.options.alphaMap,function(t){return e.alphaMap=t})}},{key:"update",value:function(){}},{key:"onComplete",value:function(){var e=this,t=this.options.alphaMap?new M.MeshBasicMaterial({map:this.texture,alphaMap:this.alphaMap,opacity:0,depthTest:!0,blending:2,transparent:!0}):new M.MeshBasicMaterial({map:this.texture,opacity:0,depthTest:!0,transparent:!0}),n=new M.PlaneGeometry(this.size.x,this.size.y),a=new M.Mesh(n,t);a.visible=!1,a.rotation.x=-1.5707963,a.position.set(this.boundsPixel[0].x+this.size.x/2,void 0===this.options.offsetY?-1:this.options.offsetY,this.boundsPixel[0].y-this.size.y/2),this.group.add(a),console.log("loading done..."),this.mesh=a;var i={_progress:0};this.tl=new G.a({paused:!0,onUpdate:function(t){e.mesh.material.opacity=.5*i._progress}}),this.tl.from(i,0,{_progress:0}).to(i,1,{_progress:1})}},{key:"setOpacity",value:function(e,t){this.mesh&&this.tl&&(this.direction=t,this.tl.tweenTo(e))}}]),e}();n(177);var J=n(180),K=new function e(){Object(u.a)(this,e),this.sceneSwitch$=new J.a,this.sceneProgress$=new J.a},U=function(e){function t(){var e,n;Object(u.a)(this,t);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return(n=Object(p.a)(this,(e=Object(d.a)(t)).call.apply(e,[this].concat(i)))).canvasRef=r.a.createRef(),n}return Object(f.a)(t,e),Object(h.a)(t,[{key:"componentDidMount",value:function(){this.sceneManager=new A(this.canvasRef.current),this.initLayers()}},{key:"componentWillUnmount",value:function(){this.sceneManager.destroy()}},{key:"initLayers",value:function(){var e=this,t=new Y("".concat("/wroclove-data","/assets/heatmap_test.png"),[16.807336807250977,51.042667388916016,17.176219940185547,51.21006774902344],{alphaMap:"".concat("/wroclove-data","/assets/wroclaw_boundary_alpha_map.png"),offsetY:0,opacity:.75});this.sceneManager.addLayer(t),y.a.get("".concat("/wroclove-data","/assets/wroclaw-osiedla-simplified.geo.json")).then(function(t){var n=new H(t.data);e.sceneManager.addLayer(n)}),y.a.get("".concat("/wroclove-data","/assets/grid_200m_hex.csv")).then(function(t){var n=new W(t.data);e.sceneManager.addLayer(n)}),K.sceneSwitch$.subscribe(function(n){"heatmap"===n.layer&&e.sceneManager.setLayerVisibility(t,n.visible)}),K.sceneProgress$.pipe(Object(g.a)(),Object(b.a)(10)).subscribe(function(n){"heatmap"===n.layer&&e.sceneManager.setLayerOpacity(t,n.progress,n.direction)})}},{key:"render",value:function(){return r.a.createElement("div",{className:x.a.wrapper},r.a.createElement("canvas",{ref:this.canvasRef,className:x.a.canvas}))}}]),t}(o.Component),X=n(89),Q=n(90),ee=n.n(Q),te=function(e,t,n){return"M 0,0 0,".concat(n," ").concat(t,",").concat(n," ").concat(t,",0 0,0 Z M 0,0 ").concat(t,",0 ").concat(t,",").concat(n," 0,").concat(n," Z")},ne=function(e,t,n){return"M 0,0 0,".concat(n," ").concat(t,",").concat(n," ").concat(t,",0 0,0 Z M ").concat(e,",").concat(e," ").concat(t,",0 ").concat(t,",").concat(n," 0,").concat(n," Z")},ae=function(e,t,n){return"M 0,0 0,".concat(n," ").concat(t,",").concat(n," ").concat(t,",0 0,0 Z M ").concat(e,",").concat(e," ").concat(t-e,",").concat(e," ").concat(t,",").concat(n," 0,").concat(n," Z")},ie=function(e,t,n){return"M 0,0 0,".concat(n," ").concat(t,",").concat(n," ").concat(t,",0 0,0 Z M ").concat(e,",").concat(e," ").concat(t-e,",").concat(e," ").concat(t-e,",").concat(n-e," 0,").concat(n," Z")},oe=function(e,t,n){return"M 0,0 0,".concat(n," ").concat(t,",").concat(n," ").concat(t,",0 0,0 Z M ").concat(e,",").concat(e," ").concat(t-e,",").concat(e," ").concat(t-e,",").concat(n-e," ").concat(e,",").concat(n-e," Z")},re=function(e){function t(){var e;return Object(u.a)(this,t),(e=Object(p.a)(this,Object(d.a)(t).call(this))).state={rect:{width:0,height:0}},e.svg=r.a.createRef(),e.path=r.a.createRef(),e.frameSize=45,e}return Object(f.a)(t,e),Object(h.a)(t,[{key:"componentDidMount",value:function(){var e=this.svg.current.getBoundingClientRect();this.setState({rect:e});var t=X.a.timeline({duration:300,easing:"easeInQuad",direction:"alternate",loop:!0}),n=this.path;t.add({targets:n.current,d:ne(this.frameSize,e.width,e.height)}).add({targets:n.current,d:ae(this.frameSize,e.width,e.height)}).add({targets:n.current,d:ie(this.frameSize,e.width,e.height)}).add({targets:n.current,d:oe(this.frameSize,e.width,e.height)}),console.log(e),console.log(ae(this.frameSize,e.width,e.height))}},{key:"render",value:function(){return r.a.createElement("svg",{className:ee.a.Frame,ref:this.svg,width:"100%",height:"100%",vievbox:"0 0 ".concat(this.state.rect.width," ").concat(this.state.rect.height)},r.a.createElement("defs",null,r.a.createElement("linearGradient",{id:"gradient1",x1:"0%",y1:"0%",x2:"0%",y2:"100%"},r.a.createElement("stop",{offset:"0%",stopColor:"#ED4264"}),r.a.createElement("stop",{offset:"100%",stopColor:"#FFEDBC"}))),r.a.createElement("path",{ref:this.path,d:te(this.frameSize,this.state.rect.width,this.state.rect.height),fill:"url(#gradient1)"}))}}]),t}(o.Component),se=n(91),ce="above",le="below",ue="inside",he="invisible",pe=function(e){function t(e){var n;return Object(u.a)(this,t),(n=Object(p.a)(this,Object(d.a)(t).call(this,e))).state={progress:0},n.refEl=r.a.createRef(),n.scrollableParent=null,n.subscriptions=[],n.handleScroll=n.handleScroll.bind(Object(m.a)(Object(m.a)(n))),n.renderArgs={},n}return Object(f.a)(t,e),Object(h.a)(t,[{key:"componentWillMount",value:function(){this.subscriptions.forEach(function(e){return e.unsubscribe()})}},{key:"componentDidMount",value:function(){this.scrollableParent=this.getScrollableParent(),this.scroll$=Object(F.a)(this.scrollableParent,"scroll",{passive:!0}),this.subscriptions.push(this.scroll$),this.scroll$.subscribe(this.handleScroll)}},{key:"handleScroll",value:function(e){var t=this.getBounds(),n=this.position,a=this.getPosition(t);this.position=a;var i={position:a};if(0===t.topOffsetPx){var o=(t.viewportBottom-t.viewportTop)/2,r=1-Math.max(Math.min((t.waypointTop-o)/o,1),0),s=1-Math.max(Math.min(-(t.waypointBottom-o)/o,1),0),c=r>s?-1:1;i.direction=c,a===ue?(i.progress=Math.min(r,s),Math.min(r,s),this.props.onProgress(i),this.setState(i)):(i.progress=0,this.setState(i))}n!==a&&(a===ue?this.props.onEnter():n===ue&&this.props.onLeave())}},{key:"getPosition",value:function(e){return e.viewportBottom-e.viewportTop===0?he:e.viewportTop<=e.waypointTop&&e.waypointTop<=e.viewportBottom?ue:e.viewportTop<=e.waypointBottom&&e.waypointBottom<=e.viewportBottom?ue:e.waypointTop<=e.viewportTop&&e.viewportBottom<=e.waypointBottom?ue:e.viewportBottom<e.waypointTop?le:e.waypointTop<e.viewportTop?ce:he}},{key:"getBounds",value:function(){var e,t,n=this.refEl.current,a=this.props.horizontal,i=n.getBoundingClientRect(),o=i.left,r=i.top,s=i.right,c=i.bottom,l=a?o:r,u=a?s:c;this.scrollableParent===window?(e=a?window.innerWidth:window.innerHeight,t=0):(e=a?n.offsetWidth:n.offsetHeight,t=a?n.getBoundingClientRect().left:n.getBoundingClientRect().top);var h=this.props,p=h.bottomOffset,d=fe(h.topOffset,e);return{contextScrollTop:t,topOffsetPx:d,contextHeight:e,waypointTop:l,waypointBottom:u,viewportTop:t+d,viewportBottom:t+e-fe(p,e)}}},{key:"getScrollableParent",value:function(){for(var e=this.props.horizontal,t=this.refEl.current;t.parentNode;){if((t=t.parentNode)===document.body)return window;var n=window.getComputedStyle(t),a=(e?n.getPropertyValue("overflow-x"):n.getPropertyValue("overflow-y"))||n.getPropertyValue("overflow");if("auto"===a||"scroll"===a)return t}return window}},{key:"render",value:function(){var e=this.props,t=e.render,n=e.children;return t&&"function"===typeof t?(this.state.cbArgs,r.a.cloneElement(t(this.state),{ref:this.refEl})):Object(se.isElement)(n)?n:r.a.createElement("div",null)}}]),t}(o.Component),de=pe;function fe(e,t){var n=function(e){if(!isNaN(parseFloat(e))&&isFinite(e))return parseFloat(e);if("px"===e.slice(-2))return parseFloat(e.slice(0,-2))}(e);if("number"===typeof n)return n;var a=function(e){if("%"===e.slice(-1))return parseFloat(e.slice(0,-1))/100}(e);return"number"===typeof a?a*t:void 0}pe.defaultProps={topOffset:"0px",bottomOffset:"0px",horizontalll:!1,onProgress:function(){}},pe.displayName="Scrollr";var me=n(46),ve=n.n(me),ye=function(e){function t(e){var n;return Object(u.a)(this,t),(n=Object(p.a)(this,Object(d.a)(t).call(this,e))).state={x:0,y:0},n.initEvents=n.initEvents.bind(Object(m.a)(Object(m.a)(n))),n.unsetEvents=n.unsetEvents.bind(Object(m.a)(Object(m.a)(n))),n.loop=n.loop.bind(Object(m.a)(Object(m.a)(n))),n.cursorRef=r.a.createRef(),n}return Object(f.a)(t,e),Object(h.a)(t,[{key:"componentDidMount",value:function(){this.initEvents()}},{key:"componentWillMount",value:function(){this.unsetEvents()}},{key:"initEvents",value:function(){var e=this;this.mouseMove$=Object(F.a)(window,"mousemove",{passive:!0}),this.mouseMove$.subscribe(function(t){var n=t.clientX,a=t.clientY;e.target={x:n,y:a}}),this.cursorVisible=new J.a,this.cursorVisible.pipe(Object(z.a)(function(e){return e<25}),Object(g.a)()).subscribe(function(t){e.cursorRef.current.classList.toggle(ve.a.active,!t)}),this.raf=requestAnimationFrame(this.loop)}},{key:"loop",value:function(){if(this.target){var e=this.cursorRef.current.getBoundingClientRect(),t=(e.x,this.target.x,e.y,this.target.y,[e.x,e.y]),n=[this.target.x-e.width/2,this.target.y-e.height/2],a=Math.hypot(t[0]-n[0],t[1]-n[1]),i=(Math.atan2(n[1]-t[1],n[0]-t[0]),Math.PI,function(e,t,n){var a=e.length;if(t.length!=a)return;for(var i=[],o=0;o<a;o++)i.push(e[o]+n*(t[o]-e[o]));return i}(t,n,2));this.cursorVisible.next(a),this.cursorRef.current.style.transform="translate(".concat(i[0],"px, ").concat(i[1],"px)")}requestAnimationFrame(this.loop)}},{key:"unsetEvents",value:function(){}},{key:"render",value:function(){return r.a.createElement("div",{className:ve.a.wrapper},r.a.createElement("div",{className:ve.a.cursor,ref:this.cursorRef}))}}]),t}(o.Component);var ge=function(e){function t(){var e;return Object(u.a)(this,t),(e=Object(p.a)(this,Object(d.a)(t).call(this))).state={enabledScene:!0,enabledFrame:!1},e.toggle=e.toggle.bind(Object(m.a)(Object(m.a)(e))),e.handleWaypointEnter=e.handleWaypointEnter.bind(Object(m.a)(Object(m.a)(e))),e.handleWaypointLeave=e.handleWaypointLeave.bind(Object(m.a)(Object(m.a)(e))),e.handleWaypointProgress=e.handleWaypointProgress.bind(Object(m.a)(Object(m.a)(e))),e}return Object(f.a)(t,e),Object(h.a)(t,[{key:"toggle",value:function(e){this.setState(function(t){return Object(l.a)({},e,!t[e])})}},{key:"handleWaypointEnter",value:function(){console.log("enter"),K.sceneSwitch$.next({layer:"heatmap",visible:!0})}},{key:"handleWaypointLeave",value:function(){console.log("leave"),K.sceneSwitch$.next({layer:"heatmap",visible:!1})}},{key:"handleWaypointProgress",value:function(e){var t=e.progress,n=e.direction;K.sceneProgress$.next({layer:"heatmap",progress:t,direction:n})}},{key:"onPositionChange",value:function(e){}},{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:"App"},r.a.createElement("div",{className:"debug"},r.a.createElement("button",{onClick:function(){return e.toggle("enabledFrame")}},"frame on/off"),r.a.createElement("button",{onClick:function(){return e.toggle("enabledScene")}},"scene on/off")),this.state.enabledFrame&&r.a.createElement(re,null),this.state.enabledScene&&r.a.createElement(U,null),r.a.createElement(ye,null),r.a.createElement("main",null,r.a.createElement("section",{className:"map"}),r.a.createElement(de,{onProgress:this.handleWaypointProgress,onEnter:this.handleWaypointEnter,onLeave:this.handleWaypointLeave,onPositionChange:this.onPositionChange,render:function(e){e.progress;var t=e.position;return r.a.createElement("section",{className:"inside"===t?"active":""},r.a.createElement("div",{className:"page"},r.a.createElement("h1",null,r.a.createElement("span",null,"Solutions ")),r.a.createElement("p",null,r.a.createElement("span",null,"Lorem ipsum dolor sit amet, consectetur adipiscing elit. Etiam tempor posuere risus, quis interdum ligula ullamcorper vel. Duis non nisl id ex imperdiet ultricies. Duis blandit ac arcu vitae pulvinar. Morbi facilisis mi tempor felis aliquet, volutpat faucibus mauris pellentesque. Sed non consequat arcu. Phasellus bibendum nibh massa, et pretium dolor accumsan a. Nulla pellentesque nibh tellus, a molestie purus finibus nec.")),r.a.createElement("p",null,r.a.createElement("span",null,"Lorem ipsum dolor sit amet, consectetur adipiscing elit. Etiam tempor posuere risus, quis interdum ligula ullamcorper vel. Duis non nisl id ex imperdiet ultricies. Duis blandit ac arcu vitae pulvinar. Morbi facilisis mi tempor felis aliquet, volutpat faucibus mauris pellentesque. Sed non consequat arcu. Phasellus bibendum nibh massa, et pretium dolor accumsan a. Nulla pellentesque nibh tellus, a molestie purus finibus nec."))))}}),r.a.createElement("section",null),r.a.createElement("section",null)))}}]),t}(o.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(r.a.createElement(ge,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})},46:function(e,t,n){e.exports={cursor:"CursorParallax_cursor__14cNF",active:"CursorParallax_active__3J2um",wrapper:"CursorParallax_wrapper__Rq-RK"}},56:function(e,t,n){e.exports={canvas:"SceneContainer_canvas__2pnsa",wrapper:"SceneContainer_wrapper__3kzlN"}},90:function(e,t,n){e.exports={Frame:"Frame_Frame__Z95oO"}},93:function(e,t,n){e.exports=n(174)},98:function(e,t,n){}},[[93,2,1]]]);
//# sourceMappingURL=main.1b3db9b3.chunk.js.map